var Jmap=function(b){var e={},d=google.maps,g={},f={},a={},c={eventsBind:function(k,n){for(var l=0,h=k.length;l<h;l++){var m=k[l].fn;d.event.addDomListener(k[l].obj,j(k[l].type),function(){m.call(n);});}function j(i){typeNew="";switch(i){case"movestart":typeNew="dragstart";break;}return typeNew;}},overlaysType:{overlay:"overlays",marker:"markers"},init:function(h){Jock.extend(f,Jock.map.options||{});Jock.extend(f,h||{});if(!f.elm||typeof google.maps!=="object"){return;}f.latlng=this.getLatLng(f);if(f.d&&typeof console!="undefined"){console.log(f);}Jock.extend(g,Jock.map.icOpts||{});f.elm=document.getElementById(f.elm);f.elm.style.background="none";this.setWH();this.createMap();},setWH:function(h){var i=f.elm.style;if(h||!i.width){i.width="auto";}if(h||!i.height){i.height=(Jock.getHeight()-f.top)+"px";}},getMapWH:function(){return{width:Jock.getWidth(),height:f.elm.style.height};},createMap:function(){gWindow=new d.InfoWindow;Jock.extend(g,f||{});var h={zoom:g.zoom,center:g.latlng,streetViewControl:false,mapTypeId:d.MapTypeId.ROADMAP};e=new d.Map(g.elm,h);if(!f.u3d){e.setOptions({mapTypeControl:false});}if(!!f.mark){this.addMarker(g);}e.setOptions({navigationControl:true});if(!!f.ctype){e.setOptions({navigationControlOptions:{style:d.NavigationControlStyle.DEFAULT}});}else{e.setOptions({navigationControlOptions:{style:d.NavigationControlStyle.SMALL}});}if(!f.ezoom){e.setOptions({scrollwheel:false});}if(!!f.scale){e.setOptions({scaleControl:true});}},setOverlaysVisible:function(i,l,k){var j=a[i];for(var h in j){this.setOverlayVisible(i,h,l);}},setOverlayVisible:function(i,h,j){if(a[i]&&a[i][h]){a[i][h].setVisible(j||false);}},getOverlay:function(i,h){a[i]=a[i]?a[i]:{};return a[i][h];},getOverlays:function(h){return a[h]?a[h]:undefined;},clearOverlays:function(){e.clearOverlays();a={};},removeOverlays:function(i){var j=a[i];for(var h in j){this.removeOverlay(i,h);}},removeOverlay:function(j,i){if(a[j][i]){var h=a[j][i];h.setMap(null);delete a[j][i];}},pushOverlayList:function(i,h,j){a[i]=a[i]?a[i]:{};a[i][h]=j;},getLatLng:function(h){var h=h||f;return new d.LatLng(h.lat,h.lng);},getMap:function(){return e||{};},reset:function(){e.panTo(f.latlng);e.setZoom(f.zoom);},getBounds:function(){return e.getBounds();},getBoundsWE:function(j){var h=this.getBounds(),i=h.getSouthWest(),k=h.getNorthEast();return{swlat:i.lat(),nelat:k.lat()-0.002,swlng:i.lng(),nelng:k.lng()};},inBounds:function(i){var h=e.getBounds();if(typeof h==="object"){return h.contains(i);}return true;},_getProjection:function(){function i(){this.setMap(e);}i.prototype=new d.OverlayView();i.prototype.onAdd=function(){};i.prototype.draw=function(){};i.prototype.onRemove=function(){};var h=new i();return h.getProjection();},pointToPixel:function(i){var h=new d.OverlayView();h.draw=function(){};h.setMap(e);return h.getProjection().fromLatLngToContainerPixel(i);},addMarker:function(n,k,j){n.latlng=n.latlng?n.latlng:this.getLatLng(n);var m=j||this.buildOverlayKey(n.latlng),i=k||this.overlaysType.overlay;if(this.getOverlay(i,m)){return;}if(this.inBounds(n.latlng)){var h=new d.Marker({position:n.latlng,map:e,icon:this.getMarkerImage(n||g),title:(!!n.title)?n.title:""});if(n.showInfo){var l=this;d.event.addDomListener(h,"click",function(){l.openMarkerWindow(n);});}this.pushOverlayList(i,m,h);return h;}},getMarkerImage:function(h){return new d.MarkerImage(h.icon,new d.Size(h.size.w,h.size.h),new d.Point(h.imgOffset.x,h.imgOffset.y===0?0:-(h.imgOffset.y)),new d.Point(h.offset.x,h.offset.y));},openWindow:function(i){gWindow.close();var h={content:i.popInfo,position:i.latlng};if(typeof i.offset!="undefined"){ops.pixelOffset=new d.Size(i.offset.x,i.offset.y);}gWindow.setOptions(h);gWindow.open(e);},openMarkerWindow:function(h){this.openWindow(h);},openOverlayWindow:function(h){this.openWindow(h);},addOverlay:function(m,k,j){m.latlng=m.latlng?m.latlng:this.getLatLng(m);var l=j||this.buildOverlayKey(m.latlng),i=k||this.overlaysType.overlay;if(this.getOverlay(this.overlaysType.overlay,l)){return;}function n(q,r){this._obj=r;this.p=q||{};this.setMap(e);}n.prototype=new d.OverlayView();n.prototype.onAdd=function(q){this._map=q;this._CName=!!this.p.className?this.p.className:"";this._CHover=!!this.p.classHover?this.p.classHover:"";this._barOffsetX=(this.p.barOffset&&this.p.barOffset.x)?this.p.barOffset.x:0;this._barOffsetY=(this.p.barOffset&&this.p.barOffset.y)?this.p.barOffset.y:0;var p=this;var r=document.createElement("DIV");r.style.position="absolute";r.style.cursor="pointer";r.style.zIndex=0;if(p._CName){r.className=p._CName;}r.innerHTML=this.p.barInfo;r.title=!!this.p.title?this.p.title:"";if(p.p.showInfo){Jock.event.add(r,"click",function(){p._obj.openOverlayWindow(p.p);});}Jock.event.add(r,"mouseover",function(){r.style.zIndex=1;if(p._CName&&p._CHover){r.className=p._CName+" "+p._CHover;}});Jock.event.add(r,"mouseout",function(){r.style.zIndex=0;if(p._CName){r.className=p._CName;}});var o=this.getPanes();o.overlayImage.appendChild(r);this._div=r;return r;};n.prototype.draw=function(){var p=this.getProjection();var o=p.fromLatLngToDivPixel(this.p.latlng);this._div.style.left=parseInt(o.x+this._barOffsetX)+"px";this._div.style.top=parseInt(o.y+this._barOffsetY)+"px";};n.prototype.onRemove=function(){this.div_.parentNode.removeChild(this.div_);this.div_=null;};n.prototype.remove=function(){this.setMap(null);};n.prototype.setVisible=function(o){if(this._div){this._div.style.visibility=(o)?"visible":"hidden";}};var h=new n(m,this);this.pushOverlayList(i,l,h);return h;},buildOverlayKey:function(h){return h.lat()+"_"+h.lng();},getGeocoder:function(h,j,i){},sw3d:function(){},sw2d:function(){},localSearch:function(h,l,m,j){if(typeof GlocalSearch==="undefined"){return;}var i=new GlocalSearch(),k=this;i.clearResults();i.setSearchCompleteCallback(null,function(t){var q=[],p=t.results,n=p.length;while(n--){var o=p[n];var u={};u.title=o.title;u.point=k.getLatLng({lat:o.lat,lng:o.lng});u.address=o.addressLines[0]+o.addressLines[1];q.push(u);}if(l&&m){m.call(l,q,j);}},[i,j]);i.setCenterPoint(e.getCenter());i.setResultSetSize(8);i.execute(h);}};c.init(b);return c;};